![ADM-ch15-graphs-topological-sort](ADM-ch15-graphs-topological-sort.best.png)

- **15.2 Topological Sorting**  
  - **Input description**  
    - The input is a directed acyclic graph (DAG) represented as G = (V, E).  
    - A DAG is also known as a partial order or poset.  
  - **Problem description**  
    - The goal is to find a linear ordering of vertices such that for each edge (i, j), vertex i appears before vertex j.  
    - This linear ordering is called a topological sort or linear extension.  
  - **Discussion**  
    - Topological sorting orders vertices and edges of a DAG in a simple and consistent way.  
    - It is fundamental for task scheduling under precedence constraints.  
    - Three key facts: only DAGs can be topologically sorted; every DAG has at least one topological sort; many valid orders may exist.  
  - **Algorithms and complexity**  
    - The simplest linear-time algorithm uses sources (vertices with in-degree zero), removes their edges, and repeats, running in O(n + m) time.  
    - An alternate algorithm orders vertices by decreasing DFS finishing times, also producing a linear extension.  
  - **Special considerations**  
    - Listing all linear extensions may be required but can be exponential in number and is NP-hard to count.  
    - Backtracking algorithms and random sampling techniques exist to handle all linear extensions.  
    - For non-acyclic graphs, feedback vertex and arc sets remove minimal conflicting items to restore acyclicity, though these problems are NP-complete.  
  - **Implementations**  
    - Popular graph libraries like Boost Graph Library, LEDA, and JGraphT include topological sorting routines.  
    - The Combinatorial Object Server offers C programs for generating and counting linear extensions.  
    - The book's associated C library also provides implementations for topological sorting.  
  - **Notes and further reading**  
    - Counting linear extensions is #P-complete, a complexity class including NP-hard problems.  
    - Efficient algorithms exist for generating linear extensions in constant amortized time with adjacency transpositions.  
    - Sampling linear extensions uniformly at random can be done in expected O(nÂ³ log n) time.  
    - Key references include [CLRS01](https://mitpress.mit.edu/books/introduction-algorithms), Brightwell and Winkler [BW91], and Pruesse and Ruskey [PR86].  
  - **Related problems**  
    - Related topics include general sorting algorithms and feedback edge/vertex set problems.
